<!DOCTYPE html>

<html>

  <head>

    <title> Posts </title>

</head>


<body>
    
    <script type = "text/javascript">



            function send() {

                console.log("Sending...");
                fetch('/addPost', {
                    method: 'POST',
                    body: new URLSearchParams({
                        topic: document.getElementById("topic_input").value,
                        data: document.getElementById("data_input").value
                    }).toString(),
                    headers: {"Content-type": "application/x-www-form-urlencoded"}
                })
                .then(response => response.json())
                .then(fname => console.log(fname))
                .catch(error => console.error(error))
                alert("New employee inserted");
            }



            function read() {
                fetch('/getPosts', {
                    method: 'GET'
                })
                .then(response => response.json())
                .then(data => {document.getElementById("output").value =
                JSON.stringify(data)})
                .catch(error => console.error(error)) 
            }

        // function getPost(){

        //     var http = new XMLHttpRequest();
        //     var url = '/getPosts';
       
        //     http.open('GET', url, true);

        //     http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        //     http.onreadystatechange = function() { 

        //         if(http.readyState == 4 && http.status == 200) {


        //             var allPosts = http.responseText;

        //             var obj = JSON.parse(allPosts);  // dict with one value and key is rows
        //             array_of_dict = obj["rows"];
                    
        //             table = document.getElementById("table");
        //             t_row = 1;

        //             clearTable();



        //             for (var i = 0; i < array_of_dict.length; i++) {

        //                 var newRow = table.insertRow(table.length);

        //                 var cell0 = newRow.insertCell(0);
        //                 var cell1 = newRow.insertCell(1);



        //                 table.rows[t_row].cells[0].innerHTML = temp_id = array_of_dict[i]["topic"]
        
        //                 table.rows[t_row].cells[1].innerHTML = temp_id = array_of_dict[i]["data"]
                    

        //                 t_row = t_row + 1;

        //                 }

        //         }
        //     };

        //     http.send();

        // };

        // function makePost(){

        //     var http = new XMLHttpRequest();
        //     var url = '/addPost';

        //     var params ='topic=' + document.getElementById("topic_input").value + '&data=' + document.getElementById("data_input").value;
       
        //     http.open('POST', url, true);

        //     http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

        //     http.onreadystatechange = function() { 

        //         if(http.readyState == 4 && http.status == 200) {
            
        //             alert(http.responseText);  
        //         }
        //     };

        //     http.send(params);};



        // function clearTable() {
        //     var table = document.getElementById("table");
        //     var numRows = table.rows.length;
  
        //     // Remove all rows except the header row
        //     for (var i = 1; i < numRows; i++) {
        //         table.deleteRow(1);
        //     }   
        // }



    </script>


    <label for="topic"> TOPIC: </label> 
    <input id="topic_input" type="text" name="topic" value="enter the topic here">  </input> <br></br>

    <label for="data"> DATA: </label>
    <input id="data_input" type="text" name="data" value="enter the data here">  </input> <br></br>

    <button onclick="send()"> SUBMIT </button>
    <br></br>


    <button onclick="read()"> GET POSTS </button>


    <textarea id="output" rows="20" cols="100"> </textarea>

<!-- 
    <table id="table" border="2" class="styled-table">

        <!-- ROW 0 That is the heading -->
        <!-- <tr id="ttr">
            <th>TOPIC</th>
            <th>DATA</th>
        </tr>

        <tr>
            <td></td>
            <td></td>
        </tr>


    </table> -->


</body>

</html>